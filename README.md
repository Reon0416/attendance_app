# 体調&モチベーション把握のできる勤怠管理システム

https://attendance-app-0416.vercel.app

(設定画面のボタンは一時的に押せないようにしています)

## 概要

本システムは、勤怠管理とあわせて従業員の「健康状態」と「モチベーション」を可視化できる Web アプリケーションです。
出勤打刻と同時に、その日の体調ややる気を簡単に入力し推移をグラフにして表示することでオーナーが従業員の体調状況を把握できるようになっています。

## 開発に至った理由と背景

私が実際に働いているアルバイト先での課題を解決したいと思ったことが開発のきっかけです。
深夜営業の飲食店で学生アルバイトが多く働いているのですが、学業との両立によって体調を崩す人も少なくありませんでした。
しかし、そのような体調の変化や負担状況を店長が事前に把握することができず、当日に急な欠員が発生して現場が対応に追われることが度々ありました。
さらに、勤怠管理や給与計算は紙ベースで行われており、情報が分散していて集計や確認に手間がかかることも課題でした。
これらの問題を解決するために、アルバイトの体調と勤怠情報を一元管理し、欠員リスクを早めに察知できる仕組みをつくりたいと考え、本プロダクトの開発に至りました。

## 具体的な課題

- 勤怠管理や給与計算等のバックオフィス業務を紙で行っていること
- 従業員の体調不良による急な欠員の発生

## 課題に対する解決策

- 勤怠打刻や給与計算のシステム化
- 出勤時に健康チェックを行い、結果をグラフとして可視化する(連続で体調不良が記録された場合はオーナーの管理画面にリスト化される)
- 目標金額と欲しいもの設定して、そこに対しての距離を可視化する

## 技術スタック

| カテゴリ           | 技術                                                    |
| ------------------ | ------------------------------------------------------- |
| フロントエンド     | React + TypeScript                                      |
| バックエンド       | Express + Node.js                                       |
| データベース       | PostgreSQL                                              |
| ORM                | Prisma                                                  |
| ルーティング       | React Router                                            |
| 認証               | JWT（JSON Web Token）                                   |
| パスワードハッシュ | bcrypt                                                  |
| 開発・ビルドツール | Vite / Node.js / npm 　　　　　　　　　　｜             |
| デプロイ           | Vercel / Railway 　　　　　　　　　　　　　　　　　　｜ |

## 主な機能 3 つ

| 機能                 | 機能の内容                                                                                                                                                                                                                                                                                 |
| -------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| **従業員の体調把握** | 従業員は出勤時に今日の体調とモチベーションを入力します。入力されたデータはグラフによって可視化されると同時に過去 7 日間のデータがポイントとして累積され、一定値を超えたら従業員への警告とオーナーへの通知が実行されます。この機能により従業員の健康状態把握と欠員の予測を手助けします。    |
| **目標と給与計算**   | 給与自動計算は従業員の勤怠情報をもとに通常勤務と深夜勤務にわけて計算されます。また、目標金額とほしいものを設定することで現在のその金額の達成率とあといくら稼ぐ必要があるのかを可視化します。この機能により従業員のモチベーションを少しでも上げて、モチベーション低下による欠員を防ぎます。 |
| **オーナー管理**     | オーナー管理画面で、従業員の体調推移のグラフ、警告の出ている従業員のリスト、従業員全員の給与の合計(人件費)等を見ることができます。                                                                                                                                                         |

## 詳細機能

| No  | 機能名                       | 概要                                                                                           | 対応課題           |
| --- | ---------------------------- | ---------------------------------------------------------------------------------------------- | ------------------ |
| 1   | **健康チェックアンケート**   | 出勤時に体調・モチベーションを -5~5 で入力。累積され一定値以上ならオーナー管理画面でリスト化。 | 健康状態の把握     |
| 2   | **リアルタイム給与計算**     | 打刻履歴から給与を自動計算し、現時点での報酬を表示(通常勤務と深夜勤務)                         | モチベーション維持 |
| 3   | **金額目標設定・達成度表示** | 目標金額とほしいものを設定し、達成度を数値・円グラフで表示。                                   | モチベーション維持 |
| 4   | **ワンタップ打刻機能**       | 出勤・退勤・休憩をワンタップで操作。押し間違いを防止。                                         | 勤怠管理の簡略化   |
| 5   | **健康状態グラフ化**         | 身体・精神両面の推移をグラフで可視化&従業員の給与の合計                                        | 健康状態の把握     |
| 6   | **オーナー管理画面**         | 従業員全員の体調と勤怠を一覧で確認可能。 一定値を超えたらリスト化                              | 欠員予測・効率化   |
| 7   | **設定画面**                 | 　ユーザー ID 変更、パスワード変更、時給変更、アカウント作成                                   | 特になし           |

## 工夫したところ

| 工夫                       | 詳細                                                                                          |
| --- | ---------------------------- |
| **ローリング集計方式の実装**   | 従業員の体調悪化をより正確に検知するため、直近 7 日間の累積ポイントを基準に判定するローリング集計方式を実装したことです。現在時刻から 7 日前までのデータのみを抽出し、その合計値があらかじめ設定した閾値を超えた場合に、自動で警告を発生させる仕組みとしています。開発当初は、警告発生時や週単位でポイントをリセットする方式を検討していました。しかしこの方式では、週の切り替わりをまたいで体調が悪化した場合、実際には連続して不調が続いているにもかかわらず、ポイントが分断されてしまい、正確な傾向把握ができないという課題がありました。特に勤務形態が不規則なアルバイト環境では、曜日を基準とした評価が実態に合わないケースが多いと考えました。そこで、固定の週区切りを設けず、「常に過去 7 日間」を評価対象とする方式に変更しました。これにより、曜日に依存せず、いつ入力しても直近 7 日間をまとまりとして評価できるようになり、体調やモチベーションの悪化が連続して発生している状況を、より実態に近い形で検知できるように工夫しました。記録日時を基準にデータベースから動的に対象期間を抽出することで、柔軟かつ拡張性のある判定ロジックを実現しています。 |
| **認証を用いたAPI認証**     | API の安全性を確保するため、ログイン以外のすべてのリクエストに対して JWT と Cookie を用いた認証を必須とする設計にしました。各リクエスト時にブラウザから自動送信される Cookie に含まれる JWT をバックエンド側で検証し、認証情報が無効な場合は処理を続行せずにエラーを返し、ログイン画面にリダイレクトするようにしています。この仕組みにより、フロントエンド側の画面遷移やバリデーションだけに依存せず、サーバー側で一律にアクセス制御を行うことができ、未ログイン状態での API 利用や不正なトークンによるデータ操作を防止できます。結果として、実運用を想定したセキュアな API 設計を実現しています。                         |
| **ボタンの制御** | 打刻操作を業務フローに沿って正しく行えるようにするため、フロントエンドで出勤状態を表すステータスを定義し、その状態に応じて押下可能なボタンを制御する仕組みを実装たことです。出勤前、出勤中、休憩中、休憩後といった勤務状況を状態として管理し、現在の状態に応じて操作可能な打刻ボタンのみを有効化することで、不正な順序での打刻を防いでいます。また、画面表示時にはバックエンドから最新の打刻履歴を取得し、その内容をもとに現在の勤務状態を判定しています。これにより、ブラウザをリロードした場合でもフロントエンドとバックエンドの状態がずれることなく、常に正しい勤務状況に基づいた操作が可能となるようにしています。さらに、API 通信中は loading 状態を持たせてすべてのボタンを一時的に無効化することで、通信遅延や連打による二重送信を防止しています。実際の運用環境を想定し、ユーザーの誤操作によって打刻データに不整合が生じないよう配慮した点も、本機能における技術的な工夫の一つです。                                   |



## 実際の画面

### 勤怠画面

<img width="800" height="700" alt="Image" src="https://github.com/user-attachments/assets/a329e77c-707c-4f58-aecb-264c3f584364" />

### 体調推移グラフ画面

<img width="800" height="700" alt="Image" src="https://github.com/user-attachments/assets/d2d2f85a-87f4-491c-8b22-a5befff7b54f" />

### 目標&給与画面

<img width="800" height="700" alt="Image" src="https://github.com/user-attachments/assets/4f4d45d7-387a-486a-aa9d-ea1e52694657" />

### 設定画面

<img width="800" height="700" alt="Image" src="https://github.com/user-attachments/assets/64095581-a182-4e31-a10d-0f55a1084fe3" />

### オーナー管理画面

<img width="800" height="700" alt="Image" src="https://github.com/user-attachments/assets/c8dfe6ad-82e4-41ff-af75-52f4cb2a2f9a" />

### 従業員給与まとめ

<img width="800" height="700" alt="Image" src="https://github.com/user-attachments/assets/68090547-1e4b-4455-b59b-87262b8d9b17" />
